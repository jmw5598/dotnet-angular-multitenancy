<nz-layout [@fadeAnimation] nzTheme="light">
  <nz-sider nzCollapsible nzWidth="250px" [nzCollapsed]="isCollapsed$ | async" [nzTrigger]="null" nzTheme="light" class="bordered-right">
    <div class="logo bordered-bottom flex flex-row justify-content-center align-items-center">
      <img style="display: block; max-height: 32px;" src="assets/images/logo.svg">
    </div>
    <ul 
        class="bordered-none"
        nz-menu 
        nzTheme="light" 
        nzMode="inline" 
        *ngIf="userPermissionsMap$ | async as permissions">
      <ng-container *ngFor="let link of defaultNavigationMenu">
        <ng-container *ngIf="link?.children?.length; else singleNavigationLinkTemplate">
          <li 
              nz-submenu 
              [nzTitle]="link.label" 
              [nzIcon]="link?.icon || ''"
              *ngIf="permissions | xyzHasModulePermission: link.requireModulePermissionType">
            <ul>
              <ng-container *ngFor="let sublink of link?.children">
                <li nz-menu-item>
                  <a [routerLink]="sublink?.routerLink || ''">{{ sublink?.label }}</a></li>
              </ng-container>
            </ul>
          </li>
        </ng-container>
        <ng-template #singleNavigationLinkTemplate>
          <li nz-menu-item *ngIf="permissions | xyzHasModulePermission: link.requireModulePermissionType">
            <i nz-icon [nzType]="link?.icon || ''"></i>
            <span><a [routerLink]="[link?.routerLink || '']">{{ link?.label || '' }}</a></span>
          </li>
        </ng-template>
      </ng-container>
    </ul>
  </nz-sider>
  <nz-layout>
    <nz-header class="flex flex-row justify-content-between align-items-center bordered-bottom">
      <div class="h-100 px-4">
        <i
            class="trigger"
            nz-icon
            [nzType]="(isCollapsed$ | async) ? 'menu-unfold' : 'menu-fold'"
            (click)="onToggleNavigationMenu()">
        </i>
      </div>
      <nz-avatar
          class="mr-4"
          nz-dropdown 
          [nzDropdownMenu]="menu" 
          [nzShape]="'circle'" 
          [nzSize]="'large'" 
          [nzIcon]="'user'"
          nzPlacement="bottomRight">
      </nz-avatar>
      <nz-dropdown-menu #menu="nzDropdownMenu">
        <ul nz-menu>
          <li nz-menu-item>
            <a routerLink="/auth/logging-out">Log out</a>
          </li>
        </ul>
      </nz-dropdown-menu>
    </nz-header>
    <nz-content>
      <router-outlet></router-outlet>
    </nz-content>
    <nz-footer>Â©2022</nz-footer>
  </nz-layout>
</nz-layout>
